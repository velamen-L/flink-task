# AIç¼–ç¨‹è„šæ‰‹æ¶ä½¿ç”¨æŒ‡å— - ç®€åŒ–ç‰ˆ

## ğŸ¯ æ ¸å¿ƒç†å¿µ

åŸºäº**åŠ¨æ€è·¯ç”± + çƒ­éƒ¨ç½² + é˜¿é‡Œäº‘Catalog**çš„AIç¼–ç¨‹è„šæ‰‹æ¶ï¼Œå®ç°ï¼š
- âœ… **Topicä¸­åŒ…å«å®Œæ•´æ•°æ®**ï¼Œæ— éœ€å…³è”é¢å¤–ç»´è¡¨
- âœ… **åŠ¨æ€è·¯ç”±**æ”¯æŒæ–°äº‹ä»¶ç±»å‹çƒ­éƒ¨ç½²  
- âœ… **é˜¿é‡Œäº‘Catalog**ç®€åŒ–è¡¨é…ç½®
- âœ… **AIä»£ç ç”Ÿæˆ**ï¼Œæ¨¡æ¿é©±åŠ¨å¼€å‘

## ğŸ“ ä¼˜åŒ–åçš„æ–‡ä»¶ç»“æ„

```
flink-task/
â”œâ”€â”€ sql/
â”‚   â””â”€â”€ wrongbook_wide_table_catalog.sql   # åŸºäºCatalogçš„SQL
â”œâ”€â”€ src/main/java/com/flink/realtime/
â”‚   â””â”€â”€ business/
â”‚       â””â”€â”€ WrongbookWideTableApp.java     # é”™é¢˜æœ¬ä¸“ç”¨åº”ç”¨ï¼ˆå·²é›†æˆåŠ¨æ€è·¯ç”±ï¼‰
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ ai-job-generator.py               # AIä½œä¸šç”Ÿæˆå™¨ â­
â”‚   â”œâ”€â”€ examples/
â”‚   â”‚   â””â”€â”€ wrongbook-wide-table-config.json  # é…ç½®æ–‡ä»¶ç¤ºä¾‹
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ dynamic-routing-template.json  # åŠ¨æ€è·¯ç”±æ¨¡æ¿ â­
â””â”€â”€ docs/
    â””â”€â”€ AIç¼–ç¨‹è„šæ‰‹æ¶ä½¿ç”¨æŒ‡å—-ç®€åŒ–ç‰ˆ.md
```

### ğŸ—‘ï¸ å·²åˆ é™¤çš„å†—ä½™æ–‡ä»¶
- âŒ `WrongRecordDataStreamApp.java` (CDCæ¨¡å¼)
- âŒ `WrongQuestionFixRecord.java` (CDCä¸“ç”¨å®ä½“)
- âŒ `wrong_record_wide_table.sql` (CDC SQL)
- âŒ ç›¸å…³é…ç½®å’Œæ–‡æ¡£æ–‡ä»¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä½¿ç”¨AIç”Ÿæˆå™¨åˆ›å»ºæ–°ä½œä¸š

```bash
# åŸºäºé…ç½®ç”Ÿæˆå®Œæ•´ä½œä¸š
python scripts/ai-job-generator.py \
  scripts/examples/wrongbook-wide-table-config.json \
  --type both

# åªç”ŸæˆSQL
python scripts/ai-job-generator.py \
  scripts/examples/wrongbook-wide-table-config.json \
  --type sql
```

### 2. é…ç½®æ–‡ä»¶ç¤ºä¾‹

```json
{
  "domain": "wrongbook",
  "job_name": "é”™é¢˜æœ¬å®æ—¶å®½è¡¨",
  "event_types": [
    {
      "type": "wrongbook_add",
      "description": "é”™é¢˜æ·»åŠ äº‹ä»¶",
      "payload_fields": [
        {"name": "userId", "type": "String", "required": true},
        {"name": "questionId", "type": "String", "required": true},
        {"name": "subject", "type": "String", "required": false},
        {"name": "subjectName", "type": "String", "required": false}
      ]
    }
  ]
}
```

### 3. è¿è¡Œç”Ÿæˆçš„ä½œä¸š

```bash
# æ‰§è¡Œç”Ÿæˆçš„å¯åŠ¨è„šæœ¬
./generated/start-wrongbook-job.sh

# æˆ–æ‰‹åŠ¨æäº¤
$FLINK_HOME/bin/flink run \
  --class com.flink.realtime.business.WrongbookWideTableApp \
  target/flink-task-1.0-SNAPSHOT.jar wrongbook
```

## ğŸ”„ åŠ¨æ€è·¯ç”±å’Œçƒ­éƒ¨ç½²

### æ–°å¢äº‹ä»¶ç±»å‹çš„æ­¥éª¤

1. **æ›´æ–°è·¯ç”±é…ç½®**ï¼ˆæ— éœ€é‡å¯ä½œä¸šï¼‰
```json
{
  "event_type": "wrongbook_review",
  "processor_class": "com.flink.realtime.processor.impl.WrongbookReviewProcessor",
  "enabled": true,
  "hot_deployable": true
}
```

2. **æ·»åŠ å¤„ç†å™¨ç±»**
```java
public class WrongbookReviewProcessor implements EventProcessor {
    @Override
    public Object process(BusinessEvent event) throws Exception {
        // æ–°çš„ä¸šåŠ¡é€»è¾‘
    }
}
```

3. **é…ç½®ç”Ÿæ•ˆ**ï¼ˆé€šè¿‡é…ç½®æºçƒ­éƒ¨ç½²ï¼‰
- æ•°æ®åº“é…ç½®è¡¨æ›´æ–°
- 30ç§’å†…è‡ªåŠ¨ç”Ÿæ•ˆ
- æ”¯æŒç‰ˆæœ¬æ§åˆ¶å’Œå›æ»š

## ğŸ“Š Topicæ•°æ®æ ¼å¼

### ç»Ÿä¸€äº‹ä»¶æ ¼å¼ï¼ˆå·²åŒ…å«å®Œæ•´ä¸šåŠ¡æ•°æ®ï¼‰
```json
{
  "domain": "wrongbook",
  "type": "wrongbook_add", 
  "timestamp": 1640995200000,
  "eventId": "evt_123456",
  "payload": {
    "userId": "user_123",
    "questionId": "q_456",
    "subject": "math",
    "subjectName": "æ•°å­¦",
    "patternId": "pattern_789",
    "chapterId": "chapter_001",
    "chapterName": "äºŒæ¬¡å‡½æ•°",
    "wrongTime": 1640995200000,
    "createTime": 1640995100000
  }
}
```

**å…³é”®ä¼˜åŒ–**: Topicä¸­å·²åŒ…å«`subject`ã€`subjectName`ã€`chapterId`ã€`chapterName`ç­‰å­—æ®µï¼Œ**æ— éœ€å…³è”`wrong_question_record`è¡¨**ã€‚

## ğŸ—ï¸ æ¶æ„ä¼˜åŠ¿

### 1. ç®€åŒ–çš„æ•°æ®æµ
```
Kafka Topic (å®Œæ•´æ•°æ®)
    â†“ äº‹ä»¶è¿‡æ»¤
    â†“ åŠ¨æ€è·¯ç”± (çƒ­éƒ¨ç½²)
    â†“ å¿…è¦ç»´è¡¨å…³è” (ä»…pattern/teaching_type)
    â†“ MySQLè¾“å‡º
```

### 2. æ”¯æŒçš„åœºæ™¯
- âœ… **æ–°äº‹ä»¶ç±»å‹**ï¼šé€šè¿‡é…ç½®çƒ­éƒ¨ç½²ï¼Œæ— éœ€ä»£ç é‡æ–°éƒ¨ç½²
- âœ… **ä¸šåŠ¡é€»è¾‘å˜æ›´**ï¼šé€šè¿‡å¤„ç†å™¨ç±»çƒ­æ›¿æ¢
- âœ… **å¤šç§Ÿæˆ·**ï¼šä¸åŒåŸŸä½¿ç”¨ç›¸åŒæ¶æ„
- âœ… **A/Bæµ‹è¯•**ï¼šé€šè¿‡è·¯ç”±é…ç½®æ§åˆ¶æµé‡

### 3. é˜¿é‡Œäº‘é›†æˆ
- **VVPå¹³å°**ï¼šç›´æ¥æäº¤ç”Ÿæˆçš„SQL
- **Catalogç®¡ç†**ï¼šè¡¨ç»“æ„ç»Ÿä¸€ç®¡ç†ï¼Œæ— éœ€é‡å¤å®šä¹‰
- **å®æ—¶è®¡ç®—**ï¼šæ”¯æŒDataStreamå’ŒSQLä¸¤ç§æ¨¡å¼

## ğŸ”§ å¼€å‘å·¥ä½œæµ

### æ—¥å¸¸å¼€å‘æµç¨‹
1. **å®šä¹‰é…ç½®**ï¼šç¼–å†™ä¸šåŠ¡é…ç½®JSON
2. **AIç”Ÿæˆ**ï¼šä½¿ç”¨ç”Ÿæˆå™¨åˆ›å»ºä½œä¸šä»£ç 
3. **æµ‹è¯•éªŒè¯**ï¼šæœ¬åœ°æµ‹è¯•æˆ–æäº¤é›†ç¾¤
4. **çƒ­éƒ¨ç½²**ï¼šé€šè¿‡é…ç½®æ›´æ–°æ”¯æŒæ–°éœ€æ±‚

### æ–°ä¸šåŠ¡åŸŸæ¥å…¥
1. **å¤åˆ¶æ¨¡æ¿**ï¼šåŸºäº`wrongbook`æ¨¡æ¿
2. **ä¿®æ”¹é…ç½®**ï¼šæ›´æ–°åŸŸåå’Œäº‹ä»¶ç±»å‹
3. **ç”Ÿæˆä»£ç **ï¼šä½¿ç”¨AIç”Ÿæˆå™¨
4. **éƒ¨ç½²è¿è¡Œ**ï¼šä¸€é”®å¯åŠ¨

## ğŸ“ˆ ç›‘æ§å’Œè¿ç»´

### å…³é”®æŒ‡æ ‡
- **äº‹ä»¶å¤„ç†é€Ÿç‡**ï¼šå®æ—¶ç›‘æ§å„äº‹ä»¶ç±»å‹å¤„ç†æƒ…å†µ
- **çƒ­éƒ¨ç½²æˆåŠŸç‡**ï¼šé…ç½®æ›´æ–°çš„æˆåŠŸç‡
- **æ–°äº‹ä»¶ç±»å‹é‡‡ç”¨ç‡**ï¼šæ–°å¢äº‹ä»¶ç±»å‹çš„ä½¿ç”¨æƒ…å†µ

### æ•…éšœæ’æŸ¥
- **é…ç½®éªŒè¯**ï¼šè‡ªåŠ¨éªŒè¯è·¯ç”±é…ç½®æ­£ç¡®æ€§
- **ç‰ˆæœ¬å›æ»š**ï¼šæ”¯æŒé…ç½®ç‰ˆæœ¬ç®¡ç†å’Œå¿«é€Ÿå›æ»š
- **å¤„ç†å™¨éš”ç¦»**ï¼šå•ä¸ªå¤„ç†å™¨æ•…éšœä¸å½±å“å…¶ä»–äº‹ä»¶ç±»å‹

## ğŸ‰ æ€»ç»“

è¿™å¥—AIç¼–ç¨‹è„šæ‰‹æ¶å®ç°äº†ï¼š

1. **æ¶æ„ç®€åŒ–**ï¼šå»é™¤ä¸å¿…è¦çš„è¡¨å…³è”å’Œæ–‡ä»¶
2. **åŠ¨æ€æ‰©å±•**ï¼šæ”¯æŒæ–°äº‹ä»¶ç±»å‹çš„çƒ­éƒ¨ç½²
3. **å¼€å‘ææ•ˆ**ï¼šAIä»£ç ç”Ÿæˆï¼Œæ¨¡æ¿é©±åŠ¨
4. **è¿ç»´å‹å¥½**ï¼šé›†æˆé˜¿é‡Œäº‘ç”Ÿæ€ï¼Œç›‘æ§å®Œå–„

**æ ¸å¿ƒä»·å€¼**ï¼šä»æ‰‹å·¥ç¼–ç åˆ°é…ç½®é©±åŠ¨ï¼Œä»é™æ€éƒ¨ç½²åˆ°åŠ¨æ€è·¯ç”±ï¼Œå®ç°çœŸæ­£çš„æ•æ·å¼€å‘å’Œè¿ç»´ã€‚
