# é”™é¢˜æœ¬å®½è¡¨æ··åˆæ¶æ„ä½¿ç”¨æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†é”™é¢˜æœ¬å®æ—¶å®½è¡¨çš„æ··åˆæ¶æ„å®ç°ï¼ŒåŸºäº**AIç¼–ç¨‹è„šæ‰‹æ¶ + åŠ¨æ€è·¯ç”± + é˜¿é‡Œäº‘Catalog**çš„ç°ä»£åŒ–æ¶æ„ï¼Œæ”¯æŒå¿«é€Ÿå¼€å‘ã€çƒ­éƒ¨ç½²å’Œçµæ´»æ‰©å±•ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä¸šåŠ¡ç³»ç»Ÿ      â”‚    â”‚   Kafkaé›†ç¾¤     â”‚    â”‚   Flinké›†ç¾¤     â”‚
â”‚                â”‚    â”‚                â”‚    â”‚                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ é”™é¢˜æœ¬      â”‚ â”‚â”€â”€â”€â–¶â”‚ â”‚ wrongbook-  â”‚ â”‚â”€â”€â”€â–¶â”‚ â”‚ äº‹ä»¶æº      â”‚ â”‚
â”‚ â”‚ ä¸šåŠ¡äº‹ä»¶    â”‚ â”‚    â”‚ â”‚ events      â”‚ â”‚    â”‚ â”‚ KafkaSource â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚                â”‚
                                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                              â”‚ â”‚ åŠ¨æ€è·¯ç”±    â”‚ â”‚
                                              â”‚ â”‚ é…ç½®æº      â”‚ â”‚
                                              â”‚ â”‚ MySQL       â”‚ â”‚
                                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                              â”‚                â”‚
                                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                              â”‚ â”‚ åŠ¨æ€è·¯ç”±    â”‚ â”‚
                                              â”‚ â”‚ å¤„ç†å™¨      â”‚ â”‚
                                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                              â”‚                â”‚
                                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                              â”‚ â”‚ ç»´è¡¨å…³è”    â”‚ â”‚
                                              â”‚ â”‚ Broadcast   â”‚ â”‚
                                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                       â”‚
                                                       â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚   æ•°æ®è¾“å‡º      â”‚
                                              â”‚                â”‚
                                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                              â”‚ â”‚ MySQLå®½è¡¨   â”‚ â”‚
                                              â”‚ â”‚ ä¸»æµè¾“å‡º    â”‚ â”‚
                                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                              â”‚                â”‚
                                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                              â”‚ â”‚ å‘Šè­¦Topic   â”‚ â”‚
                                              â”‚ â”‚ ä¾§æµè¾“å‡º    â”‚ â”‚
                                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                              â”‚                â”‚
                                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                              â”‚ â”‚ æŒ‡æ ‡Topic   â”‚ â”‚
                                              â”‚ â”‚ ä¾§æµè¾“å‡º    â”‚ â”‚
                                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. äº‹ä»¶æºå±‚
- **Kafka Topic**: `wrongbook-events` - ç»Ÿä¸€çš„äº‹ä»¶å­˜å‚¨
- **äº‹ä»¶æ ¼å¼**: æ ‡å‡†åŒ–çš„`BusinessEvent`æ ¼å¼
- **äº‹ä»¶ç±»å‹**: `wrongbook_add`, `wrongbook_fix`, `wrongbook_delete`

#### 2. å¤„ç†å±‚
- **åŠ¨æ€è·¯ç”±**: åŸºäºé…ç½®çš„äº‹ä»¶ç±»å‹è·¯ç”±
- **å¤„ç†å™¨**: å¯æ’æ‹”çš„ä¸šåŠ¡é€»è¾‘å¤„ç†å™¨
- **ç»´è¡¨å…³è”**: åŸºäºBroadcast Stateçš„ç»´è¡¨å…³è”

#### 3. è¾“å‡ºå±‚
- **ä¸»æµè¾“å‡º**: MySQLå®½è¡¨ `dwd_wrong_record_wide_delta`
- **ä¾§æµè¾“å‡º**: å‘Šè­¦å’ŒæŒ‡æ ‡Topic

## ğŸ“Š æ•°æ®æ¨¡å‹

### 1. äº‹ä»¶æ•°æ®æ¨¡å‹

#### BusinessEventç»“æ„
```json
{
  "domain": "wrongbook",
  "type": "wrongbook_add",
  "timestamp": 1640995200000,
  "eventId": "evt_123456",
  "payload": {
    "userId": "user_123",
    "questionId": "q_456",
    "subject": "math",
    "subjectName": "æ•°å­¦",
    "patternId": "pattern_789",
    "chapterId": "chapter_001",
    "chapterName": "äºŒæ¬¡å‡½æ•°",
    "wrongTime": 1640995200000,
    "createTime": 1640995100000
  }
}
```

#### äº‹ä»¶ç±»å‹å®šä¹‰

##### wrongbook_add (é”™é¢˜æ·»åŠ äº‹ä»¶)
```json
{
  "type": "wrongbook_add",
  "description": "é”™é¢˜æ·»åŠ äº‹ä»¶",
  "payload_fields": [
    {"name": "userId", "type": "String", "required": true},
    {"name": "questionId", "type": "String", "required": true},
    {"name": "subject", "type": "String", "required": false},
    {"name": "subjectName", "type": "String", "required": false},
    {"name": "patternId", "type": "String", "required": false},
    {"name": "chapterId", "type": "String", "required": false},
    {"name": "chapterName", "type": "String", "required": false},
    {"name": "wrongTime", "type": "Long", "required": false},
    {"name": "createTime", "type": "Long", "required": false}
  ]
}
```

##### wrongbook_fix (é”™é¢˜è®¢æ­£äº‹ä»¶)
```json
{
  "type": "wrongbook_fix",
  "description": "é”™é¢˜è®¢æ­£äº‹ä»¶",
  "payload_fields": [
    {"name": "userId", "type": "String", "required": true},
    {"name": "questionId", "type": "String", "required": true},
    {"name": "wrongRecordId", "type": "String", "required": true},
    {"name": "fixTime", "type": "Long", "required": true},
    {"name": "fixResult", "type": "String", "required": true},
    {"name": "attempts", "type": "Integer", "required": false},
    {"name": "timeCost", "type": "Long", "required": false}
  ]
}
```

### 2. ç»´è¡¨æ•°æ®æ¨¡å‹

#### tower_pattern (é¢˜ç›®æ¨¡å¼ç»´è¡¨)
```sql
CREATE TABLE tower_pattern (
    id VARCHAR(50) PRIMARY KEY,
    name VARCHAR(100),
    type INT,
    subject VARCHAR(20),
    difficulty DECIMAL(5,3),
    modify_time TIMESTAMP
);
```

#### tower_teaching_type_pt (æ•™å­¦ç±»å‹å…³è”ç»´è¡¨)
```sql
CREATE TABLE tower_teaching_type_pt (
    id BIGINT PRIMARY KEY,
    teaching_type_id BIGINT,
    pt_id VARCHAR(50),
    order_num INT,
    is_delete TINYINT,
    modify_time TIMESTAMP
);
```

#### tower_teaching_type (æ•™å­¦ç±»å‹ç»´è¡¨)
```sql
CREATE TABLE tower_teaching_type (
    id BIGINT PRIMARY KEY,
    chapter_id VARCHAR(50),
    teaching_type_name VARCHAR(100),
    is_delete TINYINT,
    modify_time TIMESTAMP
);
```

### 3. ç»“æœè¡¨æ•°æ®æ¨¡å‹

#### dwd_wrong_record_wide_delta (é”™é¢˜å®½è¡¨)
```sql
CREATE TABLE dwd_wrong_record_wide_delta (
    id BIGINT PRIMARY KEY,
    wrong_id VARCHAR(50),
    user_id VARCHAR(50),
    subject VARCHAR(20),
    subject_name VARCHAR(50),
    question_id VARCHAR(50),
    question TEXT,
    pattern_id VARCHAR(50),
    pattern_name VARCHAR(100),
    teach_type_id VARCHAR(50),
    teach_type_name VARCHAR(100),
    collect_time TIMESTAMP,
    fix_id VARCHAR(50),
    fix_time TIMESTAMP,
    fix_result BIGINT,
    fix_result_desc VARCHAR(50),
    event_id VARCHAR(100),
    event_type VARCHAR(50),
    process_time TIMESTAMP
);
```

## ğŸ”„ å¤„ç†æµç¨‹

### 1. äº‹ä»¶å¤„ç†æµç¨‹

```
äº‹ä»¶æ¥æ”¶ â†’ åŠ¨æ€è·¯ç”± â†’ ä¸šåŠ¡å¤„ç† â†’ ç»´è¡¨å…³è” â†’ æ•°æ®è¾“å‡º
    â”‚           â”‚           â”‚           â”‚           â”‚
    â”‚           â”‚           â”‚           â”‚           â””â”€â”€ MySQLå®½è¡¨
    â”‚           â”‚           â”‚           â””â”€â”€ ç»´è¡¨æ•°æ®å…³è”
    â”‚           â”‚           â””â”€â”€ å¤„ç†å™¨æ‰§è¡Œ
    â”‚           â””â”€â”€ è·¯ç”±é…ç½®æŸ¥è¯¢
    â””â”€â”€ Kafkaäº‹ä»¶
```

### 2. åŠ¨æ€è·¯ç”±æœºåˆ¶

#### è·¯ç”±é…ç½®è¡¨ç»“æ„
```sql
CREATE TABLE flink_routing_config (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    event_type VARCHAR(100),
    processor_class VARCHAR(200),
    enabled TINYINT DEFAULT 1,
    hot_deployable TINYINT DEFAULT 1,
    priority INT DEFAULT 100,
    version VARCHAR(20),
    create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### è·¯ç”±é…ç½®ç¤ºä¾‹
```sql
INSERT INTO flink_routing_config (event_type, processor_class, enabled, hot_deployable, priority, version) VALUES
('wrongbook_add', 'com.flink.realtime.processor.impl.WrongbookAddProcessor', 1, 1, 100, '1.0'),
('wrongbook_fix', 'com.flink.realtime.processor.impl.WrongbookFixProcessor', 1, 1, 100, '1.0'),
('wrongbook_delete', 'com.flink.realtime.processor.impl.WrongbookDeleteProcessor', 0, 1, 90, '1.0');
```

### 3. ç»´è¡¨å…³è”æœºåˆ¶

#### ç»´è¡¨å…³è”æµç¨‹
```
ä¸»æ•°æ®æµ â†’ ç»´è¡¨çŠ¶æ€æŸ¥è¯¢ â†’ æ•°æ®å…³è” â†’ ä¸°å¯Œæ•°æ® â†’ è¾“å‡º
    â”‚           â”‚              â”‚           â”‚           â”‚
    â”‚           â”‚              â”‚           â”‚           â””â”€â”€ å®Œæ•´å®½è¡¨æ•°æ®
    â”‚           â”‚              â”‚           â””â”€â”€ ä¸šåŠ¡å­—æ®µè¡¥å……
    â”‚           â”‚              â””â”€â”€ ç»´è¡¨æ•°æ®å…³è”
    â”‚           â””â”€â”€ Broadcast State
    â””â”€â”€ ä¸šåŠ¡äº‹ä»¶æ•°æ®
```

#### ç»´è¡¨åˆ·æ–°æœºåˆ¶
- **åˆ·æ–°é—´éš”**: 30åˆ†é’Ÿ
- **åˆ·æ–°æ–¹å¼**: å…¨é‡åˆ·æ–°
- **çŠ¶æ€ç®¡ç†**: Broadcast State

## ğŸš€ å¼€å‘æŒ‡å—

### 1. ç¯å¢ƒå‡†å¤‡

#### ä¾èµ–é…ç½®
```xml
<dependencies>
    <!-- Flink Core -->
    <dependency>
        <groupId>org.apache.flink</groupId>
        <artifactId>flink-streaming-java</artifactId>
        <version>${flink.version}</version>
    </dependency>
    
    <!-- Flink Kafka Connector -->
    <dependency>
        <groupId>org.apache.flink</groupId>
        <artifactId>flink-connector-kafka</artifactId>
        <version>${flink.version}</version>
    </dependency>
    
    <!-- MySQL Connector -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>8.0.28</version>
    </dependency>
    
    <!-- JSON Processing -->
    <dependency>
        <groupId>com.fasterxml.jackson.core</groupId>
        <artifactId>jackson-databind</artifactId>
        <version>2.13.0</version>
    </dependency>
</dependencies>
```

#### é…ç½®æ–‡ä»¶
```properties
# Kafkaé…ç½®
kafka.bootstrap.servers=localhost:9092
kafka.group.id=wrongbook-wide-table-group
kafka.username=
kafka.password=

# MySQLé…ç½®
mysql.url=jdbc:mysql://localhost:3306/dwd
mysql.username=root
mysql.password=password
mysql.driver=com.mysql.cj.jdbc.Driver

# Flinké…ç½®
flink.parallelism=2
flink.checkpoint.interval=10000
```

### 2. ä¸šåŠ¡åº”ç”¨å¼€å‘

#### ä½¿ç”¨AIç”Ÿæˆå™¨
```bash
# ç”Ÿæˆé”™é¢˜æœ¬åº”ç”¨
python scripts/ai-job-generator.py scripts/examples/wrongbook-wide-table-config.json

# ç”Ÿæˆçš„Javaæ–‡ä»¶ä½ç½®
src/main/java/com/flink/realtime/business/WrongbookWideTableApp.java
```

#### æ‰‹åŠ¨å¼€å‘æ­¥éª¤
1. **åˆ›å»ºä¸šåŠ¡åº”ç”¨ç±»**
2. **é…ç½®äº‹ä»¶æº**
3. **å®ç°åŠ¨æ€è·¯ç”±**
4. **æ·»åŠ ç»´è¡¨å…³è”**
5. **é…ç½®æ•°æ®è¾“å‡º**

### 3. å¤„ç†å™¨å¼€å‘

#### å¤„ç†å™¨æ¥å£
```java
public interface EventProcessor {
    Object process(BusinessEvent event) throws Exception;
}
```

#### å¤„ç†å™¨å®ç°ç¤ºä¾‹
```java
public class WrongbookAddProcessor implements EventProcessor {
    
    @Override
    public Object process(BusinessEvent event) throws Exception {
        // 1. éªŒè¯äº‹ä»¶
        validateEvent(event);
        
        // 2. æå–æ•°æ®
        Map<String, Object> data = extractData(event);
        
        // 3. ä¸šåŠ¡å¤„ç†
        processBusinessLogic(data);
        
        // 4. è¿”å›ç»“æœ
        return data;
    }
    
    private void validateEvent(BusinessEvent event) {
        // äº‹ä»¶éªŒè¯é€»è¾‘
        if (event.getPayload() == null) {
            throw new IllegalArgumentException("äº‹ä»¶payloadä¸èƒ½ä¸ºç©º");
        }
    }
    
    private Map<String, Object> extractData(BusinessEvent event) {
        Map<String, Object> data = new HashMap<>();
        JsonNode payload = event.getPayload();
        
        data.put("userId", payload.get("userId").asText());
        data.put("questionId", payload.get("questionId").asText());
        data.put("subject", payload.get("subject").asText());
        // ... å…¶ä»–å­—æ®µæå–
        
        return data;
    }
    
    private void processBusinessLogic(Map<String, Object> data) {
        // ä¸šåŠ¡å¤„ç†é€»è¾‘
        // ä¾‹å¦‚ï¼šæ•°æ®è½¬æ¢ã€ä¸šåŠ¡è§„åˆ™éªŒè¯ç­‰
    }
}
```

## ğŸ”§ éƒ¨ç½²æŒ‡å—

### 1. æœ¬åœ°å¼€å‘ç¯å¢ƒ

#### å¯åŠ¨Kafka
```bash
# å¯åŠ¨Zookeeper
bin/zookeeper-server-start.sh config/zookeeper.properties

# å¯åŠ¨Kafka
bin/kafka-server-start.sh config/server.properties

# åˆ›å»ºTopic
bin/kafka-topics.sh --create --topic wrongbook-events --bootstrap-server localhost:9092 --partitions 3 --replication-factor 1
```

#### å¯åŠ¨MySQL
```bash
# å¯åŠ¨MySQLæœåŠ¡
sudo systemctl start mysql

# åˆ›å»ºæ•°æ®åº“å’Œè¡¨
mysql -u root -p
CREATE DATABASE dwd;
USE dwd;
-- æ‰§è¡Œå»ºè¡¨SQL
```

#### è¿è¡ŒFlinkä½œä¸š
```bash
# ç¼–è¯‘æ‰“åŒ…
mvn clean package -DskipTests

# æäº¤ä½œä¸š
$FLINK_HOME/bin/flink run \
  --class com.flink.realtime.business.WrongbookWideTableApp \
  target/flink-task-1.0-SNAPSHOT.jar wrongbook
```

### 2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### é˜¿é‡Œäº‘VVPå¹³å°
1. **åˆ›å»ºé¡¹ç›®**: åœ¨VVPæ§åˆ¶å°åˆ›å»ºæ–°é¡¹ç›®
2. **ä¸Šä¼ JAR**: ä¸Šä¼ ç¼–è¯‘å¥½çš„JARåŒ…
3. **é…ç½®ä½œä¸š**: é…ç½®ä½œä¸šå‚æ•°å’Œèµ„æºé…ç½®
4. **å¯åŠ¨ä½œä¸š**: å¯åŠ¨Flinkä½œä¸š

#### Kuberneteséƒ¨ç½²
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: wrongbook-wide-table
spec:
  replicas: 1
  selector:
    matchLabels:
      app: wrongbook-wide-table
  template:
    metadata:
      labels:
        app: wrongbook-wide-table
    spec:
      containers:
      - name: flink-jobmanager
        image: flink:1.17
        ports:
        - containerPort: 8081
        command: ["/opt/flink/bin/jobmanager.sh"]
        env:
        - name: FLINK_PROPERTIES
          value: "jobmanager.rpc.address: wrongbook-wide-table"
```

## ğŸ“Š ç›‘æ§å’Œè¿ç»´

### 1. ç›‘æ§æŒ‡æ ‡

#### å…³é”®æŒ‡æ ‡
- **äº‹ä»¶å¤„ç†é€Ÿç‡**: æ¯ç§’å¤„ç†äº‹ä»¶æ•°
- **å¤„ç†å»¶è¿Ÿ**: äº‹ä»¶ä»æ¥æ”¶åˆ°å¤„ç†çš„æ—¶é—´
- **é”™è¯¯ç‡**: å¤„ç†å¤±è´¥çš„äº‹ä»¶æ¯”ä¾‹
- **çŠ¶æ€å¤§å°**: å†…å­˜ä¸­çŠ¶æ€æ•°æ®å¤§å°

#### ç›‘æ§é…ç½®
```properties
# ç›‘æ§é…ç½®
metrics.reporter.prom.class=org.apache.flink.metrics.prometheus.PrometheusReporter
metrics.reporter.prom.port=9249
```

### 2. å‘Šè­¦è§„åˆ™

#### å‘Šè­¦é…ç½®
```yaml
alerts:
  - name: "å¤„ç†å»¶è¿Ÿè¿‡é«˜"
    condition: "processing_latency > 30s"
    severity: "critical"
    
  - name: "é”™è¯¯ç‡è¿‡é«˜"
    condition: "error_rate > 1%"
    severity: "warning"
    
  - name: "çŠ¶æ€å¤§å°å¼‚å¸¸"
    condition: "state_size > 1GB"
    severity: "warning"
```

### 3. æ•…éšœå¤„ç†

#### å¸¸è§é—®é¢˜
1. **äº‹ä»¶å¤„ç†å¤±è´¥**: æ£€æŸ¥äº‹ä»¶æ ¼å¼å’Œå¤„ç†å™¨é€»è¾‘
2. **ç»´è¡¨å…³è”å¤±è´¥**: æ£€æŸ¥ç»´è¡¨è¿æ¥å’ŒæŸ¥è¯¢SQL
3. **è¾“å‡ºå¤±è´¥**: æ£€æŸ¥MySQLè¿æ¥å’Œè¡¨ç»“æ„

#### æ•…éšœæ¢å¤
1. **é…ç½®å›æ»š**: é€šè¿‡é…ç½®æºå›æ»šåˆ°ç¨³å®šç‰ˆæœ¬
2. **ä½œä¸šé‡å¯**: é‡å¯Flinkä½œä¸š
3. **æ•°æ®ä¿®å¤**: é‡æ–°å¤„ç†å¤±è´¥çš„æ•°æ®

## ğŸ”„ æ‰©å±•æŒ‡å—

### 1. æ·»åŠ æ–°äº‹ä»¶ç±»å‹

#### æ­¥éª¤1: æ›´æ–°é…ç½®
```json
{
  "event_type": "wrongbook_review",
  "processor_class": "com.flink.realtime.processor.impl.WrongbookReviewProcessor",
  "enabled": true,
  "hot_deployable": true,
  "priority": 100
}
```

#### æ­¥éª¤2: å¼€å‘å¤„ç†å™¨
```java
public class WrongbookReviewProcessor implements EventProcessor {
    @Override
    public Object process(BusinessEvent event) throws Exception {
        // å®ç°æ–°çš„ä¸šåŠ¡é€»è¾‘
    }
}
```

#### æ­¥éª¤3: çƒ­éƒ¨ç½²
```sql
INSERT INTO flink_routing_config (event_type, processor_class, enabled, hot_deployable, priority, version) 
VALUES ('wrongbook_review', 'com.flink.realtime.processor.impl.WrongbookReviewProcessor', 1, 1, 100, '1.0');
```

### 2. æ·»åŠ æ–°ç»´è¡¨

#### æ­¥éª¤1: åˆ›å»ºç»´è¡¨
```sql
CREATE TABLE new_dimension_table (
    id VARCHAR(50) PRIMARY KEY,
    name VARCHAR(100),
    -- å…¶ä»–å­—æ®µ
);
```

#### æ­¥éª¤2: æ›´æ–°é…ç½®
```json
{
  "name": "new_dimension_table",
  "type": "mysql",
  "key_field": "id",
  "query_sql": "SELECT * FROM new_dimension_table",
  "refresh_interval": "30m"
}
```

#### æ­¥éª¤3: ä¿®æ”¹åº”ç”¨ä»£ç 
```java
// æ·»åŠ æ–°çš„ç»´è¡¨å…³è”é€»è¾‘
```

## ğŸ‰ æ€»ç»“

é”™é¢˜æœ¬å®½è¡¨æ··åˆæ¶æ„é€šè¿‡ä»¥ä¸‹ç‰¹æ€§å®ç°äº†é«˜æ•ˆã€çµæ´»çš„å®æ—¶æ•°æ®å¤„ç†ï¼š

1. **äº‹ä»¶é©±åŠ¨**: åŸºäºKafkaçš„ç»Ÿä¸€äº‹ä»¶å­˜å‚¨å’Œåˆ†å‘
2. **åŠ¨æ€è·¯ç”±**: æ”¯æŒæ–°äº‹ä»¶ç±»å‹çš„çƒ­éƒ¨ç½²
3. **ç»´è¡¨å…³è”**: åŸºäºBroadcast Stateçš„é«˜æ•ˆç»´è¡¨å…³è”
4. **AIç”Ÿæˆ**: åŸºäºé…ç½®çš„ä»£ç è‡ªåŠ¨ç”Ÿæˆ
5. **ç›‘æ§å®Œå–„**: å…¨é¢çš„ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶

è¿™å¥—æ¶æ„ä¸ºé”™é¢˜æœ¬ä¸šåŠ¡æä¾›äº†å®Œæ•´çš„å®æ—¶æ•°æ®å¤„ç†è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒä¸šåŠ¡çš„å¿«é€Ÿå‘å±•å’ŒæŠ€æœ¯çš„æŒç»­æ¼”è¿›ã€‚
